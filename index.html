
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Andy.Lee&#39;s blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Andy.Lee">
    

    
    <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Andy.Lee's blog">
<meta property="og:url" content="http://huaqianlee.me/index.html">
<meta property="og:site_name" content="Andy.Lee's blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Andy.Lee's blog">
<meta name="twitter:description">
<meta name="twitter:creator" content="@Andylee_sarah">
<link rel="publisher" href="107850537041795428182">

    
    <link rel="alternative" href="/atom.xml" title="Andy.Lee&#39;s blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="Andy.Lee&#39;s blog" title="Andy.Lee&#39;s blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="Andy.Lee&#39;s blog">Andy.Lee&#39;s blog</a></h1>
				<h2 class="blog-motto">Good good study, day day up !</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/categories">Categories</a></li>
					
						<li><a href="/tags">Tags</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:huaqianlee.me">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
<!--<a href="https://github.com/AndyLee-Github"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/52760788cde945287fbb584134c4cbc2bc36f904/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f77686974655f6666666666662e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"></a>-->
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/19/怎么抓取Android测试日志文件(How to get android log file)/" title="怎么抓取Android日志文件" itemprop="url">怎么抓取Android日志文件</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-19T13:43:04.000Z" itemprop="datePublished"> 发表于 Jul 19 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/19/怎么抓取Android测试日志文件(How to get android log file)/" >huaqianlee.me/2015/07/19/怎么抓取Android测试日志文件(How to get android log file)/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Log/">Log</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/19/怎么抓取Android测试日志文件(How to get android log file)/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/19/怎么抓取Android测试日志文件(How to get android log file)/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/19/怎么用Android日志系统更好地去调试（How to debug with Android logging）/" title="How to debug with Android logging" itemprop="url">How to debug with Android logging</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-19T07:43:04.000Z" itemprop="datePublished"> 发表于 Jul 19 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　<a href="">Android日志系统详解</a><br>　　<a href="">How to debug with Android logging</a><br>　　<a href="">怎么抓取Android日志文件</a></p>
<p>　　Android logging system为logging系统提供了一个Java类android.util.Log，也提供了一个本地C应用在log库，在kernel中有四个设备节点，详细见：<a href="">Android日志系统详解</a>。其系统架构如下：<br>　　　<img src="http://7xjdax.com1.z0.glb.clouddn.com/blogaplogd.jpg" alt="image by simon"></p>
<blockquote>
<p>新版Android中log_kernel已改为log_system　</p>
</blockquote>
<h2 id="Java应用Logging接口">Java应用Logging接口</h2><h3 id="Logging类">Logging类</h3><p>类名：android.util.Log，主要方法如下：<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Log</span>.v();</span><br><span class="line"><span class="keyword">Log</span>.<span class="literal">d</span>();</span><br><span class="line"><span class="keyword">Log</span>.<span class="literal">i</span>();</span><br><span class="line"><span class="keyword">Log</span>.<span class="literal">w</span>();</span><br><span class="line"><span class="keyword">Log</span>.<span class="literal">e</span>();</span><br><span class="line"><span class="keyword">Log</span>.a();</span><br></pre></td></tr></table></figure></p>
<p>Log信息显示等级从高到底分别为：ERROR，WARN，INFO，DEBUG，VERBOSE。VERBOSE除了开发期间，是不应该被编译进APP的，DEBUG应该编译但在runtime被忽略，ERROR，WARN和INFO logs则一直被保留。更加详细的内容见 ：<a href="http://developer.android.com/reference/android/util/Log.html" target="_blank" rel="external">Log.html</a>。</p>
<blockquote>
<p>一个好的习惯是在自己的类中定义一个TAG常量，如：private static final String TAG = “MyActivity”;然后通过Log.i(TAG，”I am “+name);　</p>
</blockquote>
<h3 id="Demo">Demo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">package me.huaqianlee.demo;</span><br><span class="line">import android.app.Activity;</span><br><span class="line">import android.os.Bundle;</span><br><span class="line">import android.widget.TextView;</span><br><span class="line">import android.util.Log; </span><br><span class="line"></span><br><span class="line">private static final String TAG = <span class="string">"MyActivity"</span>;</span><br><span class="line"></span><br><span class="line">public class Demo extends Activity &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line"></span><br><span class="line">        TextView tv = new TextView(this);</span><br><span class="line">        tv.setText(<span class="string">"Hello, I am andy lee!"</span>);</span><br><span class="line">        <span class="built_in">set</span>ContentView(tv);</span><br><span class="line"></span><br><span class="line">        Log.i(TAG, <span class="string">"this is a log.i message"</span>);</span><br><span class="line">        Log.v(TAG, <span class="string">"this  is a log.v message"</span>);</span><br><span class="line">        Log.d(TAG, <span class="string">"this  is a log.d message"</span>);</span><br><span class="line">        Log.w(TAG, <span class="string">"this  is a log.w message"</span>);</span><br><span class="line">        Log.e(TAG, <span class="string">"this  is a log.e message"</span>);</span><br><span class="line">        Log.a(TAG, <span class="string">"this  is a log.a message"</span>);</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="本地C/C++应用Logging接口">本地C/C++应用Logging接口</h2><h3 id="Logging代码">Logging代码</h3><p>　　Log信息的等级同上，关键代码如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;cutils/log.h&gt; //路径：system/core/include/cutils/log.h</span></span><br><span class="line">/*公共日志宏*/</span><br><span class="line">ALOGV </span><br><span class="line">ALOGD </span><br><span class="line">ALOGI </span><br><span class="line">ALOGW </span><br><span class="line">ALOGE</span><br><span class="line"></span><br><span class="line">/*条件日志宏*/</span><br><span class="line">ALOGV_IF </span><br><span class="line">ALOGD_IF  </span><br><span class="line">ALOGI_IF  </span><br><span class="line">ALOGW_IF  </span><br><span class="line">ALOGE_IF </span><br><span class="line"></span><br><span class="line">// 在system/core/include/<span class="built_in">log</span>/log.h(被cutils/log.h包含)中定义如下：</span><br><span class="line"><span class="comment">#define CONDITION(cond)     (__builtin_expect((cond)!=0, 0))</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ifndef ALOGV_IF</span></span><br><span class="line"><span class="comment">#if LOG_NDEBUG</span></span><br><span class="line"><span class="comment">#define ALOGV_IF(cond, ...)   ((void)0)</span></span><br><span class="line"><span class="comment">#else</span></span><br><span class="line"><span class="comment">#define ALOGV_IF(cond, ...) \</span></span><br><span class="line">    ( (CONDITION(cond)) \</span><br><span class="line">    ? ((void)ALOG(LOG_VERBOSE, LOG_TAG, __VA_ARGS__)) \</span><br><span class="line">    : (void)<span class="number">0</span> )</span><br><span class="line"><span class="comment">#endif</span></span><br><span class="line"><span class="comment">#endif</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<ol>
<li>应该首先在c文件中定义LOG_TAG。</li>
<li>在Android.mk中添加：LOCAL_SHARED_LIBRARIES := liblog libcutils</li>
</ol>
</blockquote>
<h3 id="Demo-1">Demo</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt; </span></span><br><span class="line"><span class="comment">#include &lt;cutils/log.h&gt; /* log header file*/</span></span><br><span class="line"><span class="comment">#include &lt;cutils/properties.h&gt;</span></span><br><span class="line"></span><br><span class="line">/* define <span class="built_in">log</span> tag */</span><br><span class="line"><span class="comment">#ifdef LOG_TAG</span></span><br><span class="line"><span class="comment">#undef LOG_TAG</span></span><br><span class="line"><span class="comment">#define LOG_TAG "app"</span></span><br><span class="line"><span class="comment">#endif</span></span><br><span class="line">int <span class="function"><span class="title">main</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">    ALOGV(<span class="string">"Verbose: _app"</span>);</span><br><span class="line">    ALOGD(<span class="string">"Debug: _app"</span>);</span><br><span class="line">    ALOGI(<span class="string">"Info: _app"</span>);</span><br><span class="line">    ALOGW(<span class="string">"Warn: _app"</span>);</span><br><span class="line">    ALOGE(<span class="string">"Error: _app"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"I am andy lee！\n"</span>);</span><br><span class="line">    <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Android上的log格式">Android上的log格式</h2><p>　　　Log信息的格式及详解如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">tv_sec   tv_nsec     priority     pid    tid     tag     messageLen       Message</span><br><span class="line"></span><br><span class="line">tag: 标签</span><br><span class="line">tv_sec &amp; tv_nsec: 日志的时间戳</span><br><span class="line">pid: 打印日志的进程ID</span><br><span class="line">tid: 打印日志的线程ID</span><br><span class="line">Priority： 日志等级（或优先级），取值如下</span><br><span class="line">  V — Verbose (lowest priority)</span><br><span class="line">  D — Debug</span><br><span class="line">  I — Info</span><br><span class="line">  W — Warning</span><br><span class="line">  E — Error</span><br><span class="line">  A — Assert</span><br></pre></td></tr></table></figure></p>
<h2 id="Reference">Reference</h2><p><a href="http://log4think.com/debug-android-logging/" target="_blank" rel="external">http://log4think.com/debug-android-logging/</a><br><a href="http://developer.android.com/reference/android/util/Log.html" target="_blank" rel="external">http://developer.android.com/reference/android/util/Log.html</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/19/怎么用Android日志系统更好地去调试（How to debug with Android logging）/" >huaqianlee.me/2015/07/19/怎么用Android日志系统更好地去调试（How to debug with Android logging）/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Log/">Log</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/19/怎么用Android日志系统更好地去调试（How to debug with Android logging）/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/19/怎么用Android日志系统更好地去调试（How to debug with Android logging）/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/19/Android Logging system(Android日志系统)详解/" title="Android日志系统(logging system)详解" itemprop="url">Android日志系统(logging system)详解</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-19T05:43:04.000Z" itemprop="datePublished"> 发表于 Jul 19 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　<a href="">Android日志系统详解</a><br>　　<a href=""></a><br>　　<a href=""></a></p>
<p>　　不管是做Android应用还是做Android中间层和底层，Logging系统都是必须要了解的；因为Android不像单片机程序UCOS那么简单,可以很方便的单步调试。所以，就准备用一篇blog来分析一下logging system。</p>
<h2 id="概览">概览</h2><p>　　Android提供了一个灵活的logging系统，允许应用程序和系统组件等整个系统记录logging信息，它是独立于Linux Kernel的一个logging系统，kernel是通过”pr_info”、”printk”等存储，通过“dmesg”或“cat  /proc/kmsg”获取。不过，Android logging 系统也是将信息存在内核缓存区。其结构如下：　<br>　<br>　　　　<img src="http://7xjdax.com1.z0.glb.clouddn.com/blogAndroid-logging-system.png" alt="image by Tetsuyuki Kobabayshi"><br>　<br>Logging system由如下几部分组成：</p>
<ul>
<li>实现loging信息存储的kernel驱动和缓存区</li>
<li>C，C++和Java 类添加与读取log</li>
<li>一个单独浏览log信息的程序（logcat）</li>
<li>能够查看和过滤来自主机的log信息（通过Android Studio 或者 DDMS）</li>
</ul>
<p>其在kernel中为系统的不同部分提供了四个不同log缓存区，可以通过/dev/log查看这些不同的设备节点，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/dev/<span class="built_in">log</span>/mian ： 主应用程序<span class="built_in">log</span>，除了下两个外，其他用户空间<span class="built_in">log</span>将写入此节点</span><br><span class="line">/dev/<span class="built_in">log</span>/events ： 系统事件信息，二进制<span class="built_in">log</span>信息将写入此节点，需要程序解析</span><br><span class="line">/dev/<span class="built_in">log</span>/radio ： 射频通话相关信息，tag 为<span class="string">"HTC_RIL"</span> <span class="string">"RILJ"</span> <span class="string">"RILC"</span> <span class="string">"RILD"</span> <span class="string">"RIL"</span> <span class="string">"AT"</span> <span class="string">"GSM"</span> <span class="string">"STK"</span>的<span class="built_in">log</span>信息将写入此节点</span><br><span class="line">/dev/<span class="built_in">log</span>/system ： 低等级系统信息和debugging</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>用户空间log： main、radio、events；内核空间log：system</p>
</blockquote>
<p>log中的每条信息主要由四部分组成，如下：</p>
<ul>
<li>表明来自system还是app的标签(tag)</li>
<li>时间戳</li>
<li>log信息level(或者event的优先级)</li>
<li>log信息</li>
</ul>
<h2 id="Android_logger">Android logger</h2><p>　　logging的kernel driver部分被称作”logger”，其为系统日志提供支持，代码路径在kernel/drivers/staging/android/logger.c，此文件对4种logging缓存区加以支持。</p>
<h3 id="驱动">驱动</h3><p>　　Log的读写是通过正常Linux文件读写方式完成的，write path被很好的优化过，所以能很快的open() write() close()，这样就避免了logging在系统中有太多的开销，影响速度。</p>
<h5 id="Reading">Reading</h5><p>　　在用户空间，一个正常的read操作通常读取从log读取一个条目，每read一次返回一个log条目或者阻塞等待下一个log条目。设备可以打开非阻塞模式。每一个read请求应该至少请求LOGGER_ENTRY_MAX_LEN (4096)长度的数据。</p>
<h4 id="Writing">Writing</h4><p>　　当系统写数据到log时，driver将为每一个log条目保存pid（进程ID），tgid（线程组ID），timestamp（时间戳），这些信息将出现在用户空间的level，tag和message中。</p>
<h4 id="Ioctl">Ioctl</h4><p>　　Ioctl函数支持如下cmd：</p>
<ul>
<li>LOGGER_GET_LOG_BUF_SIZE ： log条目缓存区的大小</li>
<li>LOGGER_GET_LOG_LEN ： log数据的长度</li>
<li>LOGGER_GET_NEXT_ENTRY_LEN： 下一log条目的大小</li>
<li>LOGGER_FLUSH_LOG ： 清除log数据</li>
<li>LOGGER_GET_VERSION ： 获得logger版本</li>
<li>LOGGER_GET_VERSION ： 设置logger版本</li>
</ul>
<h3 id="设备节点">设备节点</h3><p>　　当一个用户空间执行的程序用合适的主设备号和次设备号打开设备节点后，设备节点就处于活动状态，这些设备节点如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@msm8916_32:/ <span class="comment"># ls -al dev/log</span></span><br><span class="line">ls -al dev/<span class="built_in">log</span></span><br><span class="line">crw-rw-rw- root     <span class="built_in">log</span>       <span class="number">10</span>,  <span class="number">61</span> <span class="number">1970</span>-<span class="number">01</span>-<span class="number">09</span> <span class="number">02</span>:<span class="number">14</span> events</span><br><span class="line">crw-rw-rw- root     <span class="built_in">log</span>       <span class="number">10</span>,  <span class="number">62</span> <span class="number">1970</span>-<span class="number">01</span>-<span class="number">09</span> <span class="number">02</span>:<span class="number">14</span> main</span><br><span class="line">crw-rw-rw- root     <span class="built_in">log</span>       <span class="number">10</span>,  <span class="number">60</span> <span class="number">1970</span>-<span class="number">01</span>-<span class="number">09</span> <span class="number">02</span>:<span class="number">14</span> radio</span><br><span class="line">crw-rw-rw- root     <span class="built_in">log</span>       <span class="number">10</span>,  <span class="number">59</span> <span class="number">1970</span>-<span class="number">01</span>-<span class="number">09</span> <span class="number">02</span>:<span class="number">14</span> system</span><br></pre></td></tr></table></figure></p>
<h2 id="系统和应用程序logging">系统和应用程序logging</h2><p>　　所有的log信息在Java类中定义并做相应处理，最终一个格式化的消息通过C/C++库传递到内核驱动程序,然后再将消息存储在适当的缓冲区中。</p>
<h3 id="App_log">App  log</h3><p>　　App通过导入android.util.Log包来引入Log类，然后通过log方法写不同优先级的相关信息到log。Java类定义传递到log方法的tag为字符串常量，log方法通过这些字符串来获知信息的重要性，这样，当我们用log查看工具（如logcat）时，就可以过滤tag或者优先级来获取我们想要的信息。如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">root@msm8916_32:/ <span class="comment"># logcat</span></span><br><span class="line">logcat</span><br><span class="line">--------- beginning of system</span><br><span class="line">I/Vold    (  <span class="number">265</span>): Vold <span class="number">2.1</span> (the revenge) firing up</span><br><span class="line">D/Vold    (  <span class="number">265</span>): Volume sdcard1 state changing -<span class="number">1</span> (Initializing) -&gt; <span class="number">0</span> (No-Media)</span><br><span class="line">D/Vold    (  <span class="number">265</span>): Volume uicc0 state changing -<span class="number">1</span> (Initializing) -&gt; <span class="number">0</span> (No-Media)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">D/Vold    (  <span class="number">265</span>): Volume usbotg state changing -<span class="number">1</span> (Initializing) -&gt; <span class="number">0</span> (No-Media)</span><br><span class="line"></span><br><span class="line">D/Vold    (  <span class="number">265</span>): Volume uicc1 state changing -<span class="number">1</span> (Initializing) -&gt; <span class="number">0</span> (No-Media)</span><br><span class="line">I/Cryptfs (  <span class="number">265</span>): Check <span class="keyword">if</span> PFE is activated on Boot</span><br><span class="line">E/Cryptfs (  <span class="number">265</span>): Bad magic <span class="keyword">for</span> real block device /dev/block/bootdevice/by-name/userdata</span><br><span class="line">E/Cryptfs (  <span class="number">265</span>): Error getting crypt footer and key</span><br><span class="line">I/irsc_util(  <span class="number">316</span>): irsc tool created:<span class="number">0</span>xb70ff688</span><br><span class="line">I/irsc_util(  <span class="number">316</span>): Starting irsc tool</span><br><span class="line">I/irsc_util(  <span class="number">316</span>): Trying to open sec config file</span><br></pre></td></tr></table></figure></p>
<h3 id="Event_log">Event log</h3><p>　　Event logs是在android.util.EventLog.class中创建二进制log信息。Log条目由二进制tag代码和二进制参数构成。Event logs 文件存储在system/etc/event-log-tags中，通过cat system/etc/event-log-tags能查看其信息。如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@msm8916_32:/ <span class="comment"># cat system/etc/event-log-tags</span></span><br><span class="line">cat system/etc/event-log-tags</span><br><span class="line"><span class="number">42</span> answer (to life the universe etc|<span class="number">3</span>)</span><br><span class="line"><span class="number">314</span> pi</span><br><span class="line"><span class="number">1003</span> auditd (avc|<span class="number">3</span>)</span><br><span class="line"><span class="number">2718</span> e</span><br><span class="line"><span class="number">2719</span> configuration_changed (config mask|<span class="number">1</span>|<span class="number">5</span>)</span><br><span class="line"><span class="number">2720</span> sync (id|<span class="number">3</span>),(event|<span class="number">1</span>|<span class="number">5</span>),(<span class="built_in">source</span>|<span class="number">1</span>|<span class="number">5</span>),(account|<span class="number">1</span>|<span class="number">5</span>)</span><br><span class="line"><span class="number">2721</span> cpu (total|<span class="number">1</span>|<span class="number">6</span>),(user|<span class="number">1</span>|<span class="number">6</span>),(system|<span class="number">1</span>|<span class="number">6</span>),(iowait|<span class="number">1</span>|<span class="number">6</span>),(irq|<span class="number">1</span>|<span class="number">6</span>),(softirq|<span class="number">1</span>|<span class="number">6</span>)</span><br><span class="line"><span class="number">2722</span> battery_level (level|<span class="number">1</span>|<span class="number">6</span>),(voltage|<span class="number">1</span>|<span class="number">1</span>),(temperature|<span class="number">1</span>|<span class="number">1</span>)</span><br><span class="line"><span class="number">2723</span> battery_status (status|<span class="number">1</span>|<span class="number">5</span>),(health|<span class="number">1</span>|<span class="number">5</span>),(present|<span class="number">1</span>|<span class="number">5</span>),(plugged|<span class="number">1</span>|<span class="number">5</span>),(technology|<span class="number">3</span>)</span><br><span class="line"><span class="number">2724</span> power_sleep_requested (wakeLocksCleared|<span class="number">1</span>|<span class="number">1</span>)</span><br><span class="line"><span class="number">2725</span> power_screen_broadcast_send (wakelockCount|<span class="number">1</span>|<span class="number">1</span>)</span><br><span class="line"><span class="number">2726</span> power_screen_broadcast_<span class="keyword">done</span> (on|<span class="number">1</span>|<span class="number">5</span>),(broadcastDuration|<span class="number">2</span>|<span class="number">3</span>),(wakelockCount|<span class="number">1</span>|<span class="number">1</span>)</span><br><span class="line"><span class="number">2727</span> power_screen_broadcast_stop (<span class="built_in">which</span>|<span class="number">1</span>|<span class="number">5</span>),(wakelockCount|<span class="number">1</span>|<span class="number">1</span>)</span><br><span class="line"><span class="number">2728</span> power_screen_state (offOrOn|<span class="number">1</span>|<span class="number">5</span>),(becauseOfUser|<span class="number">1</span>|<span class="number">5</span>),(totalTouchDownTime|<span class="number">2</span>|<span class="number">3</span>),(touchCycles|<span class="number">1</span>|<span class="number">1</span>)</span><br><span class="line"><span class="number">2729</span> power_partial_wake_state (releasedorAcquired|<span class="number">1</span>|<span class="number">5</span>),(tag|<span class="number">3</span>)</span><br><span class="line"><span class="number">2730</span> battery_discharge (duration|<span class="number">2</span>|<span class="number">3</span>),(minLevel|<span class="number">1</span>|<span class="number">6</span>),(maxLevel|<span class="number">1</span>|<span class="number">6</span>)</span><br><span class="line"><span class="number">2740</span> location_controller</span><br></pre></td></tr></table></figure></p>
<h3 id="System_log">System log</h3><p>　　framework层的许多类通过使用system log 来与app的log信息区分开来。System log在android.util.Slog.clash中实现。</p>
<h3 id="log命令行工具">log命令行工具</h3><p>　　log命令行工具能用来给任意程序穿件log条目，此工具是内建与toolbox的多功能程序。在adb shell中输入log则会提示其用法，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator&gt;adb shell</span><br><span class="line">root@msm8916_32:/ <span class="comment"># log</span></span><br><span class="line"><span class="built_in">log</span></span><br><span class="line">USAGE: <span class="built_in">log</span> [-p priorityChar] [-t tag] message</span><br><span class="line">        priorityChar should be one of:</span><br><span class="line">                v,d,i,w,e</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>toolbox: 具有管理内存、备份和数据清除功能的一个系统文件，用来对手机性能进行设置，需要root权限，能被软件调用。　</p>
</blockquote>
<h3 id="logwrapper">logwrapper</h3><p>　　logwrapper工具是用来捕捉stdout信息的，当需要从本地应用捕捉stdout信息到log时，它将十分有用。源码路径：system/core/logwrapper/logwrapper.c；用法如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">root@msm8916_32:/ <span class="comment"># logwrapper</span></span><br><span class="line">logwrapper</span><br><span class="line">Usage: logwrapper [<span class="operator">-a</span>] [<span class="operator">-d</span>] [-k] BINARY [ARGS ...]</span><br><span class="line"></span><br><span class="line">Forks and executes BINARY ARGS, redirecting stdout and stderr to</span><br><span class="line">the Android logging system. Tag is <span class="built_in">set</span> to BINARY, priority is</span><br><span class="line">always LOG_INFO.</span><br><span class="line"></span><br><span class="line"><span class="operator">-a</span>: Causes logwrapper to <span class="keyword">do</span> abbreviated logging.</span><br><span class="line">    This logs up to the first <span class="number">4</span>K and last <span class="number">4</span>K of the <span class="built_in">command</span></span><br><span class="line">    being run, and logs the output when the <span class="built_in">command</span> exits</span><br><span class="line"><span class="operator">-d</span>: Causes logwrapper to SIGSEGV when BINARY terminates</span><br><span class="line">    fault address is <span class="built_in">set</span> to the status of <span class="built_in">wait</span>()</span><br><span class="line">-k: Causes logwrapper to <span class="built_in">log</span> to the kernel <span class="built_in">log</span> instead of</span><br><span class="line">    the Android system <span class="built_in">log</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Logcat命令">Logcat命令</h3><p>　　我们可以通过logcat命令查看log，这个命令文件在文件系统的system/bin目录下，所以我们可以到文件系统中执行logcat，或者直接adb logcat，都能查看log。adb用法可以查看<a href="http://developer.android.com/guide/developing/tools/adb.html" target="_blank" rel="external">adb.html</a>(需翻墙，等什么时候有空以中文形式移到blog来)。</p>
<ul>
<li>每一个有tag和优先级的log信息</li>
<li>可以通过tag和log等级过滤log信息</li>
<li>可以通过系统属性指定程序将stdout和stderr内容写入日志</li>
</ul>
<h2 id="在启动阶段默认打开Logcat">在启动阶段默认打开Logcat</h2><p>　　Android logging和kernel logging是完全不同的两种日志系统，另补充一点，kernel日志支持直接在用户空间向/dev/kmsg写入log条目。<a href="http://groups.google.com/group/android-kernel/browse_thread/thread/87d929863ce7c29e/f8b0da9ed6376b2f?pli=1" target="_blank" rel="external">groups.google.com</a>中介绍了如何在启动阶段launch Logcat，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">it can be launched via init.rc as below.. </span><br><span class="line"></span><br><span class="line">service logcat /system/bin/logcat <span class="operator">-f</span> /dev/kmsg </span><br><span class="line">       oneshot</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>不推荐这样做，这样会增加打印开销，使系统卡顿　</p>
</blockquote>
<h2 id="Reference">Reference　　</h2><p><a href="http://elinux.org/Android_Logging_System" target="_blank" rel="external">http://elinux.org/Android_Logging_System</a> (大部分内容译自此文档)<br><a href="http://developer.android.com/guide/developing/tools/adb.html" target="_blank" rel="external">http://developer.android.com/guide/developing/tools/adb.html</a><br><a href="http://groups.google.com/group/android-kernel/browse_thread/thread/87d929863ce7c29e/f8b0da9ed6376b2f?pli=1" target="_blank" rel="external">http://groups.google.com/group/android-kernel/browse_thread/thread/87d929863ce7c29e/f8b0da9ed6376b2f?pli=1</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/19/Android Logging system(Android日志系统)详解/" >huaqianlee.me/2015/07/19/Android Logging system(Android日志系统)详解/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Log/">Log</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/19/Android Logging system(Android日志系统)详解/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/19/Android Logging system(Android日志系统)详解/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/12/Android编译过程详解之三/" title="Android编译过程详解之三" itemprop="url">Android编译过程详解之三</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-12T08:43:04.000Z" itemprop="datePublished"> 发表于 Jul 12 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　<a href="http://huaqianlee.me/2015/07/11/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%80/">Android编译过程详解之一</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%BA%8C/">Android编译过程详解之二</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Andro%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%89/">Android编译过程详解之三</a><br>　　<a href="http://huaqianlee.me/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk%E8%A7%A3%E6%9E%90/">Android.mk解析</a></p>
<p>　　前两个篇基本完全涉及到了整个编译过程，接下来着重分析一下和公司产品相关的mk文件。有两个路径前面没有怎么提到过，如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">build/target/product <span class="comment"># 当前产品配置的mk文件，如：需要包含哪些apk在此产品中</span></span><br><span class="line">build/target/board  <span class="comment"># 硬件芯片配置的mk文件，如：GPU、是否支持浮点运算等</span></span><br></pre></td></tr></table></figure></p>
<p>　　除以上两个路径外，对产品定义的文件通常位于device目录下，还可以定义在vender目录下（不过Google已不建议如此做了），device目录下根据公司名和产品名分为两级目录，这个上文已经介绍过。通常一个产品定义如下四个文件：</p>
<ul>
<li>AndroidProducts.mk </li>
<li>产品版本定义文件（一般针对不同应用环境存在多个，如：msm8916_32.mk）</li>
<li>BoardConfig.mk</li>
<li>verndorsetup.sh</li>
</ul>
<h2 id="AndroidProducts-mk">AndroidProducts.mk</h2>
        
        
        <p class="article-more-link">
          
            <a href="/2015/07/12/Android编译过程详解之三/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/12/Android编译过程详解之三/" >huaqianlee.me/2015/07/12/Android编译过程详解之三/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/编译/">编译</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/12/Android编译过程详解之三/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/12/Android编译过程详解之三/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/12/Android编译过程详解之二/" title="Android编译过程详解之二" itemprop="url">Android编译过程详解之二</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-12T08:43:04.000Z" itemprop="datePublished"> 发表于 Jul 12 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　<a href="http://huaqianlee.me/2015/07/11/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%80/">Android编译过程详解之一</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%BA%8C/">Android编译过程详解之二</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Andro%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%89/">Android编译过程详解之三</a><br>　　<a href="http://huaqianlee.me/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk%E8%A7%A3%E6%9E%90/">Android.mk解析</a><br>　<br>　　配置好环境变量后，接下来要做的就是build了。为了提高编译速度，我们自定义了一个go.sh的脚本文件，详细下面解释。另，编译的时候一般会在后面加一个-j8来实现多线程编译，如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　　./go.sh -j8 or make -j8／--jobs</span><br></pre></td></tr></table></figure></p>
<p>参数“-j“ 和”—jobs ”指定了同时编译的线程数量，通常是编译主机 CPU 支持的并发线程总数的 1 倍或 2 倍（如：在一个 4 核，每个核支持两个线程的 CPU 上，可以使用 make -j8 或 make -j16）。在调用 make 命令时，如果没有指定任何目标，则将编译默认目标“droid”（下面详解），然后将会编译出完整的 Android 系统镜像。</p>
<h2 id="build系统分类">build系统分类</h2><p>　　整个build系统的Make文件可以分为三类：</p>
<ol>
<li>build系统核心文件：定义整个build系统的框架，其他所有make文件都是在这个框架的基础上写出来的。</li>
<li>产品的make文件：位于device目录，通常以公司名和产品名分为两级目录，如：\device\qcom\msm8916_32。</li>
<li>模块的make文件：每个模块专用的make文件，kernel中统一名字为Makefile，其他为Android.mk。　</li>
</ol>
<h2 id="build结果">build结果</h2><p>所有的编译产物都将位于 /out 目录下，该目录下主要有以下几个子目录：</p>
<ul>
<li>/out/host/：该目录下包含了针对主机的 Android 开发工具的产物。即 SDK 中的各种工具，例如：emulator，adb，aapt 等。</li>
<li>/out/target/common/：该目录下包含了针对设备的共通的编译产物，主要是 Java 应用代码和 Java 库。</li>
<li>/out/target/product/<product_name>/：包含了针对特定设备的编译结果以及平台相关的 C/C++ 库和二进制文件。其中，<product_name>是具体目标设备的名称。</li>
<li>/out/dist/：包含了为多种分发而准备的包，通过“make disttarget”将文件拷贝到该目录，默认的编译目标不会产生该目录。
        
        
        <p class="article-more-link">
          
            <a href="/2015/07/12/Android编译过程详解之二/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/12/Android编译过程详解之二/" >huaqianlee.me/2015/07/12/Android编译过程详解之二/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/编译/">编译</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/12/Android编译过程详解之二/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/12/Android编译过程详解之二/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk解析/" title="About ActivityNotFoundException Unable to find explicit activity class &amp;&amp; Android.mk解析" itemprop="url">About ActivityNotFoundException Unable to find explicit activity class &amp;&amp; Android.mk解析</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-12T06:06:35.000Z" itemprop="datePublished"> 发表于 Jul 12 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　<a href="http://huaqianlee.me/2015/07/12/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%80/">Android编译过程详解之一</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%BA%8C/">Android编译过程详解之二</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Andro%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%89/">Android编译过程详解之三</a><br>　　<a href="http://huaqianlee.me/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk%E8%A7%A3%E6%9E%90/">Android.mk解析</a></p>
<h2 id="ActivityNotFoundException">ActivityNotFoundException 　</h2><p>　　最近将Android从4.4移植到5.1时，添加一个从拨号界面输入*#360*#进入battery info查看界面的功能时（如感兴趣，详情见<a href="http://huaqianlee.me/2015/06/06/Android%E7%94%B5%E6%B1%A0%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F-BMS-%E4%B9%8B%E7%94%B5%E6%B1%A0%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/">Android电池监控系统(bms)之一电池系统架构</a>），activity跳转部分代码如下：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">else</span> <span class="title">if</span><span class="params">(input.equals(BATTERY_INFO)</span>)</span><br><span class="line"></span>&#123;<span class="comment">//added by lihuaqian</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        ComponentName Component = <span class="keyword">new</span> ComponentName(<span class="string">"com.android.settings"</span>,<span class="string">"com.android.settings.BatteryOemInfo"</span>); </span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">        intent.setComponent(Component);</span><br><span class="line">        intent.setAction(Intent.ACTION_VIEW);   </span><br><span class="line">        context.startActivity(intent);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ActivityNotFoundException e) &#123;</span><br><span class="line">        Log.d(TAG, <span class="string">"no activity to battery cmd."</span>); </span><br><span class="line">        <span class="comment">//e.printStackTrace();   </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　遇到如下问题：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　ActivityNotFoundException : Unable to find explicit activity class; have you declared this activity <span class="keyword">in</span> your AndroidManifest.xml?</span><br></pre></td></tr></table></figure></p>
        
        
        <p class="article-more-link">
          
            <a href="/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk解析/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk解析/" >huaqianlee.me/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk解析/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Bug/">Bug</a><a href="/tags/编译/">编译</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk解析/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk解析/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/07/11/Android编译过程详解之一/" title="Android编译过程详解之一" itemprop="url">Android编译过程详解之一</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-07-11T11:43:04.000Z" itemprop="datePublished"> 发表于 Jul 11 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p><strong>　　Platform Information :<br>　　　System:    Ａndroid4.4.4<br>　　　Platform:  Qualcomm msm8916<br>　　　Author:     Andy Lee<br>　　　Email:        huaqianlee@gmail.com</strong></p>
<p><strong>欢迎指出错误，共同学习，共同进步</strong></p>
<p>　　<a href="http://huaqianlee.me/2015/07/11/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%80/">Android编译过程详解之一</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Android%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%BA%8C/">Android编译过程详解之二</a><br>　　<a href="http://huaqianlee.me/2015/07/12/Andro%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3%E4%B9%8B%E4%B8%89/">Android编译过程详解之三</a><br>　　<a href="http://huaqianlee.me/2015/07/12/About-ActivityNotFoundException-Unable-to-find-explicit-activity-class-Android-mk%E8%A7%A3%E6%9E%90/">Android.mk解析</a><br>　<br>　　Google给出的编译环境和构建方法见：<a href="http://source.android.com/source/initializing.html">http://source.android.com/source/initializing.html</a>，过程见：<a href="http://source.android.com/source/building.html">http://source.android.com/source/building.html</a>，不过这是解释怎么编译一个通用的系统，没有详细描述细节，而且需要翻墙。接下来我就准备跟着高通平台的编译过程来详细了解一下。</p>
<p>我平时的编译步骤如下：<br>　1. source setup.sh project-name debug/release　加载命令配置环境　<br>　2. ./go.sh  [target] or make  [target]　编译<br>
        
        
        <p class="article-more-link">
          
            <a href="/2015/07/11/Android编译过程详解之一/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/07/11/Android编译过程详解之一/" >huaqianlee.me/2015/07/11/Android编译过程详解之一/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/编译/">编译</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/07/11/Android编译过程详解之一/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/07/11/Android编译过程详解之一/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/06/11/git常用及进阶命令总结/" title="Git常用及进阶命令总结" itemprop="url">Git常用及进阶命令总结</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-06-11T14:10:41.000Z" itemprop="datePublished"> 发表于 Jun 11 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　Git是Linux撞始人Linus Towards花一周写出来的分布式版本控制系统，大神终究是大神，这么牛逼的东西只需要一周。之前花了一百多刀买了Linus的原版自传《Just for fun》，基本上是他自己写的，很幽默，有兴趣可以看看。Linus很傲，但是傲得有资本，唯一能无视Jobs的现实扭曲力场，对Jobs的盛情邀请say no转身而去的人。　<br>　<br>　　言归正传，Git十分好用，应用也十分广泛,现在最好的代码托管网站Github就是基于git创建的，而且现在大多数公司及都在使用它进行代码管理，要熟练使用还是需要花一些苦功夫的，我现在也还只是会基本的应用，更深层次的使用还不熟悉。为了方便自己以后使用，将自己常用的一些命令加以总结，并Google了一些常用及进阶命令，一并列出，方便查询使用。</p>
        
        
        <p class="article-more-link">
          
            <a href="/2015/06/11/git常用及进阶命令总结/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/06/11/git常用及进阶命令总结/" >huaqianlee.me/2015/06/11/git常用及进阶命令总结/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Git/">Git</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/Tools/">Tools</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/06/11/git常用及进阶命令总结/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/06/11/git常用及进阶命令总结/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/06/06/Android电池监控系统-BMS-之电池系统架构/" title="Android电池监控系统(BMS)之一电池系统架构" itemprop="url">Android电池监控系统(BMS)之一电池系统架构</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-06-06T14:17:36.000Z" itemprop="datePublished"> 发表于 Jun 6 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p><em>Platform Information :<br>　System:    Ａndroid4.4.4<br>　Platform:  Qualcomm msm8916<br>　Author:     Andy Lee<br>　Email:        huaqianlee@gmail.com</em></p>
<p><strong>如有错误欢迎指出，共同学习，共同进步</strong><br>　<br>　　电池对移动设备的重要性不言而喻，所以电池监控系统也是Android的重中之重。今天就结合工作中的内容来分析一下电池监控系统。</p>
<h2 id="电池系统架构">电池系统架构</h2><p>　　Android中的电池使用方式包括AC（即电源适配器）、Wireless（无线充电）、USB、Battery 等不同的模式。在APP层，通常包括电池状态显示等功能。在framework层 ，主要包括从底层获取电池信息、电池管理、LED控制、绘制更新充电图标等功能。因此，bms主要负责电池状态信息读取和更新相应状态。其架构如下：　<br>　<br>　　<img src="http://7xjdax.com1.z0.glb.clouddn.com/201566Android-bms-arch.png" alt="电池系统架构"></p>
<p>自上而下，Android电池监控系统分为如下几个部分：</p>
<h3 id="电池信息查看APP">电池信息查看APP</h3><p>　　此部分主要是指查看电池信息的APP，比如电池医生、手机内置的电池信息查看APP等。这里就用工作的为例，在拨号状态下输入*#360*#，则会打开电池信息查看APP。如下所示：<br>
        
        
        <p class="article-more-link">
          
            <a href="/2015/06/06/Android电池监控系统-BMS-之电池系统架构/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/06/06/Android电池监控系统-BMS-之电池系统架构/" >huaqianlee.me/2015/06/06/Android电池监控系统-BMS-之电池系统架构/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/电源管理/">电源管理</a>
  </div>

</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/06/06/Android电池监控系统-BMS-之电池系统架构/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/06/06/Android电池监控系统-BMS-之电池系统架构/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2015/05/30/Android电源管理架构/" title="Android 电源管理架构" itemprop="url">Android 电源管理架构</a>
  </h1>

  
  <p class="article-author">By
       
		<a href="https://plus.google.com/107850537041795428182?rel=author" title="Andy.Lee" target="_blank" itemprop="author">Andy.Lee</a>
		
  <p class="article-time">
    <time datetime="2015-05-30T08:04:45.000Z" itemprop="datePublished"> 发表于 May 30 2015</time>
    
  </p>
  
</header>
    <div class="article-content">
        
        <p>　　对于移动设备，电源管理是相当重要的一部分，因为现在在公司主要负责电源管理部分，所以借用Google对其研究了一下，再结合自己的工作经验，准备接下来写一系列相关的文章。因为现在还研究得不够，所以最初的文章会不够深入。不过我会慢慢研究，然后写一些比较详细的解读。</p>
<h2 id="高通的引导体系结构">高通的引导体系结构</h2><p><img src="http://7xjdax.com1.z0.glb.clouddn.com/20155304921b788-8a63-472f-be7c-2220a98cf428.jpg" alt="boot"><br><strong>SBL- Second BootLoader</strong><br>
        
        
        <p class="article-more-link">
          
            <a href="/2015/05/30/Android电源管理架构/#more">Read More</a>
          
       </p>
    </div>
    <footer class="article-footer clearfix">
	
<div>

  	<span> </span>
  	本文为原创文章，出自<a href="/">Andy Lee's blog</a><br/>
	欢迎转载，但请注明原地址: <a href="/2015/05/30/Android电源管理架构/" >huaqianlee.me/2015/05/30/Android电源管理架构/ </a>

</div>
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/Android/">Android</a>
</div>


</div>




<div class="comments-count">
	
	  	<span></span>
		<a href="/2015/05/30/Android电源管理架构/#comments" class="ds-thread-count comments-count-link" data-thread-key="2015/05/30/Android电源管理架构/" data-count-type="comments">&nbsp;</a>
	
</div>


</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/Android/" title="Android">Android<sup>11</sup></a></li>
		  
		
		  
			<li><a href="/categories/Git/" title="Git">Git<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Hexo/" title="Hexo">Hexo<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Java/" title="Java">Java<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Life/" title="Life">Life<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Linux/" title="Linux">Linux<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/Thinking/" title="Thinking">Thinking<sup>1</sup></a></li>
		  
		
		  
		
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/Tools/" title="Tools">Tools<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/编译/" title="编译">编译<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/Log/" title="Log">Log<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/文件IO/" title="文件IO">文件IO<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/kernel/" title="kernel">kernel<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/Experience/" title="Experience">Experience<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/电源管理/" title="电源管理">电源管理<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Program-Kill/" title="Program Kill">Program Kill<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/网络/" title="网络">网络<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Android-Studio/" title="Android Studio">Android Studio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/shell/" title="shell">shell<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Bug/" title="Bug">Bug<sup>1</sup></a></li>
			
		
			
		
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://blog.daimajia.com/" target="_blank" title="代码家">代码家</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.stormzhang.com/" target="_blank" title="stormzhang">stormzhang</a>
            
          </li>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Andy Lau in Hongkong. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/huaqianlee" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		<a href="https://github.com/AndyLee-Github" target="_blank" class="icon-github" title="github"></a>
		
		
		<a href="http://stackoverflow.com/users/4511267/huaqian-lee" target="_blank" class="icon-stack-overflow" title="stackoverflow"></a>
		
		
		<a href="https://twitter.com/Andylee_sarah" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/huaqianlee" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		
		
		<a href="http://www.zhihu.com/people/huaqianlee" target="_blank" class="icon-zhihu" title="知乎"></a>
		
		
		<a href="https://plus.google.com/107850537041795428182?rel=author" target="_blank" class="icon-google_plus" title="Google+"></a>
		
		
		<a href="mailto:huaqianlee@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/AndyLee-Github/customtheme" target="_blank" title="Andy Lee">Andy Lee</a> © 2015 
		
		<a href="/about" target="_blank" title="Andy.Lee">Andy.Lee</a>
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>




<script type="text/javascript">
  var duoshuoQuery = {short_name:"AndyLee"};
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
    || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script> 


<script type="text/javascript">

var disqus_shortname = 'AndyLee';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-63838023-1', 'huaqianlee.me');  
ga('send', 'pageview');
</script>



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F5ab1107031547fb5411cd06ed47f1348## e.g. e6d1f421bbc9962127a50488f9ed37d1 your baidu tongji site code' type='text/javascript'%3E%3C/script%3E"));
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
